<% content_for :title do %>ホーム<% end %>
<% content_for :meta_tags do %>
  <%= display_meta_tags(:description => "目標を紹介するWebサービスです。") %>
<% end %>
<%= render 'shared/header' %>
<%= render 'shared/sidemenu' %>
<%= stylesheet_link_tag "top" %>

<%= render 'shared/side-ads' %>
<%= render 'shared/ads-mobile' %>

<div class="content_wrap">
  

<div id="aims">
  <%= render @aims %>
</div>

<%= link_to 'More aims', '#', id: 'load-more' %>

  <%= link_to "もっと読み込む", url_for(page: @page.to_i + 1) %>

  <button id="add_aim_btn" class="add_aim_btn btn btn-primary">
      さらに表示
  </button>

  <%= link_to "0", url_for(page: 0) %>

  <%= link_to "1", url_for(page: 1) %>
    <%= link_to "2", url_for(page: 2) %>
  <%= link_to "3", url_for(page: 3) %>
  <%= link_to "4", url_for(page: 4) %>

</div>

<script>
gon=2;
$(document).on('click', '.add_aim_btn', function(e) {
  e.preventDefault();
  $.ajax({
    url: '/',
    dataType: 'script',
    type: 'GET',
    data: { page: gon.page },
    success: function(response) {
      gon.page += 1;
      //console.log("response"+response)
    }
  });
});
/*
// 記事のテンプレート
const articleTemplate = (article) => {
  return `
    <div>
      <h2>${aim.title}</h2>
      <p>${aim.content}</p>
    </div>
  `
}
  let page = 1 // ページング
  $articles =""
  articles=""
  $('#add_aim_btn').on('click', () => {
    page += 1 
    $.get('/', {page: page}, (data) => {
        // 読み込んだ記事を追加表示 
        console.log(data)
        // すでに読み込んだ分とマージ
        const articles = [...$articles, ...data.articles]
        //const articles = [...articles, ...data.articles]  
        //const articles = [...page, ...data.articles]  
        //const articles =" aaa"

        // HTMLを結合
        let html = '';
        articles.forEach(article => {
          html += articleTemplate(article); 
        });

        // 表示を更新
        $('#aims').append(html);

        // 読み込んだ分を保存 
        $articles = articles;
      })
  })  
  */
  /*var page = 2;
  $(document).on('click', '#add_aim_btn', function() {
 // $('#add_aim_btn').click(function() {
    console.log("s")
    $.ajax({
      url: '/top/index',
      data: { page: page },
      dataType: 'script'
    });
    page++;
 });
 */
</script>

<%= render 'shared/ads-mobile' %>
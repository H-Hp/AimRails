<!DOCTYPE html>
<html>
  <head>
    <title><%= yield (:title) %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <%= yield :meta_tags %>

    <!-- <%= favicon_link_tag 'favicon.ico' %> -->
    <%= cloudfront_favicon_link_tag 'favicon.ico' %>
    
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.2/css/all.css" integrity="sha384-/rXc/GQVaYpyDdyxK+ecHPVYJSN9bmVFBvjA/9eOB+pb3F2w2N6fc5qB9Ew5yIns" crossorigin="anonymous">
    
    <!-- <%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track': 'reload' %> 
    <%= cloudfront_stylesheet_link_tag 'application.css', media: 'all' , as: 'style' %>
    <%= cloudfront_stylesheet_link_tag 'application.css', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= cloudfront_stylesheet_link_tag 'application.css', media: 'all', 'data-turbolinks-track': 'reload' %>
    -->
    
    <!--<%= javascript_pack_tag 'application', 'data-turbolinks-track': 'reload' %>
    <script src="https://d2hcwuo8gsf97u.cloudfront.net/packs/js/application-a19bc2af213c4adc9762.js" data-turbolinks-track="reload"></script>
    <script src="<%= cloudfront_javascript_pack_tag 'all' %>" data-turbolinks-track="reload"></script>
    -->

    <%= stylesheet_link_tag "header" %>

    
    <% if Rails.env.development? %>
      <%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track': 'reload' %> 
      <%= javascript_pack_tag 'application', 'data-turbolinks-track': 'reload' %>
    <% else %>
      <%= cloudfront_stylesheet_link_tag 'application.css', media: 'all', 'data-turbolinks-track': 'reload' , as: 'style' %>
      <script src="<%= cloudfront_javascript_pack_tag 'application' %>" data-turbolinks-track="reload"></script>
    <% end %>

    <!-- Google アナリティクスtag (gtag.js) --> <script async src="https://www.googletagmanager.com/gtag/js?id=G-KJYSMQ091V"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-KJYSMQ091V'); </script>
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-LPEYP3Q3WT"></script>


    <!--通知のPushCode-->
<script defer src="https://www.pushcode.jp/dist/js/pushcode.js"></script>
<link rel="manifest" href="/manifest.json">
<script>
window.PushCodeInit = function() {
  try {
    if (PushCode && PushCode.isSupport()) {
      PushCode.init({ domainToken: 'b9d13fd35759e6d49f4384be5657c5ce33e3eb0f3b921ea99ff04eb9351e1306', userid: '' });
        PushCode.components.openSubscribeDialog();
    }
  }
  catch (err) {
    console.error(err);
    if (PushCode) {
      PushCode.sendError(err);
    }
  }
};
</script>
    </head>

  <body>
  
  

<main>

    <% flash.each do |key, value| %>
      <div class="flash <%= key %>">
        <%= value %>
      </div>
    <% end %>
    <%= yield %>
</main>



<!-- jQuery と Bootstrap 読込-->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

<script>
$(function(){
	$(".Logo , .LogoTitle").click(function() {//セレクタorでどっちかにマッチ
		location.href="/";
	});

  // ローカルストレージから値を取得
  const theme = localStorage.getItem('theme');
  const stretch = localStorage.getItem('stretch');

  if (theme === 'light') {
    design_light();
  } else {
    design_dark();
  }

  if (stretch === 'open') {
    stretch_open();
  } else if (stretch === 'close'){
    stretch_close();
  }else {
    stretch_open();
  }

	$(".stretch-btn").click(function() {
    stretch_close();
	});
  
  $(".stretch-btn-open").click(function() {
    stretch_open();
	}); 
 
  function stretch_close(){
    console.log(".stretch-btn");
    //$(".stretch-btn").toggleClass("menu-open");
		$(".Left").css("width","25px") ;
    $("main").css("left","10px") ;
    $("main").css("width","100%") ;
    $(".stretch-btn").hide();$(".stretch-btn-open").show();
    $(".Left-content").hide();
    /*$(".stretch-btn").addClass(".stretch-btn-close");
    //$("#myElement").removeClass("old-class").addClass(new-cl
    if (sideMenu.style.left === "0px") {
        // サイドメニューが開いている場合、閉じる
        sideMenu.style.left = "-250px";
    } else {
        // サイドメニューが閉じている場合、開く
        sideMenu.style.left = "0px";
    }*/
    localStorage.setItem('stretch', 'close');
  }
  function stretch_open(){
    console.log(".stretch-btn");
		$(".Left").css("width","20%") ;
    $("main").css("left","20%") ;
    $("main").css("width","80%") ;
    $(".stretch-btn-open").hide();$(".stretch-btn").show();
    $(".Left-content").show();
    localStorage.setItem('stretch', 'open');
  }
  

  $(".design-light").click(function() {
		design_light();
	});
  $(".design-dark").click(function() {
    design_dark();
	});
  
  function design_light(){
    console.log("design-light");
    $("body").css("background-color","white") ;
    $("main").css("background-color","white") ;
    $("header").css("background-color","#F5F6F6") ;
    $(".SearchBox").css("background-color","white") ;
    $(".Left").css("background-color","#F5F6F6") ;

    $("main").css("color","black") ;
    $(".SearchBox").css("color","black") ;

    $(".user-icon button").css("color","black") ;
    $(".copyright").css("color","black") ;
    
    $(".Left a").css("color","black") ;
    $(".design-light").hide();$(".design-dark").show();
    $(".Logo-black").show();$(".Logo-white").hide();
    localStorage.setItem('theme', 'light');
  }

  function design_dark(){
    console.log("design-dark");
    $("body").css("background-color","#121920") ;
    $("main").css("background-color","#000000") ;
    $("main").css("color","white") ;
    $("header").css("background-color","#202020") ;
    $(".SearchBox").css("background-color","#121212") ;
    $(".SearchBox").css("color","white") ;
    $(".Left").css("background-color","#212121") ;
    $(".Left a").css("color","white") ;
    $(".copyright").css("color","white") ;

    $(".design-light").show();$(".design-dark").hide();
    $(".Logo-black").hide();$(".Logo-white").show();
    localStorage.setItem('theme', 'dark');

    $(".user-icon button").css("color","white") ;
    $(".search-form-input").css("color","black") ;
  }
	
});


</script>



<style>
.stretch-btn.menu-open{
  width: 10px;
}
</style>

<script>
//こっからヘッダーの処理
$(function(){

// 要素を取得
const toggleArrow = document.getElementById("arrow");

const dropdownBtn_user_icon = document.getElementById("header-user-icon-btn");
const dropdownMenu_user_icon = document.getElementById("dropdown-user-icon");
// Toggle dropdown function
const toggleDropdown_user_icon = function () {
  dropdownMenu_user_icon.classList.toggle("show");
  //toggleArrow.classList.toggle("arrow");
};
// Toggle dropdown open/close when dropdown button is clicked
dropdownBtn_user_icon.addEventListener("click", function (e) {
  e.stopPropagation();
  toggleDropdown_user_icon();
  dropdownMenu_notifications.style.zIndex = -1;
  dropdownMenu_user_icon.style.zIndex = 10000;
});
// Close dropdown when dom element is clicked
document.documentElement.addEventListener("click", function () {
  if (dropdownMenu_user_icon.classList.contains("show")) {
    toggleDropdown_user_icon();

  }
});

const dropdownBtn_notifications = document.getElementById("notifications-button");
const dropdownMenu_notifications = document.getElementById("dropdown-notifications");
// Toggle dropdown function
const toggleDropdown_notifications = function () {
  dropdownMenu_notifications.classList.toggle("show");
  //toggleArrow.classList.toggle("arrow");
};
// Toggle dropdown open/close when dropdown button is clicked
dropdownBtn_notifications.addEventListener("click", function (e) {
  e.stopPropagation();
  toggleDropdown_notifications();
  dropdownMenu_user_icon.style.zIndex = -1;
  dropdownMenu_notifications.style.zIndex = 10000;
  

});
// Close dropdown when dom element is clicked
document.documentElement.addEventListener("click", function () {
  if (dropdownMenu_notifications.classList.contains("show")) {
    toggleDropdown_notifications();
  }
});

/*
//ログアウト
const logout_btn = document.getElementById("logout-btn");
logout_btn.addEventListener("click", function (e) {
  fetch('/logout', {
    method: 'POST', 
  })
  .then((response) => {
    if (!response.ok) {
      throw new Error('Network response was not ok');
    }
    return response.json();
  })
  .then((data) => {
    console.log('Success:', data);
  })
  .catch((error) => {
    console.error('Error:', error);
  });
});

*/

});
//こっからヘッダーの処理ここまで
</script>

</body>
</html>
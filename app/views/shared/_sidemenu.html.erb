<%= stylesheet_link_tag "user-ranking" %>

<div class="Left">
 

  <div class="Left-content">

      <div class="UserRanking_wrap">
            <h4>ユーザーランキング</h4>
            <% 
            #@aa = User.where(id: 1).limit(10)
            @rank_users = User.joins(:aims)
                        .group("users.id")
                        .order("count(aims.id) DESC")
                        .limit(3)
            i=1;
            @rank_users.each do |user|
                @this_user=user
                #user_ranking_user_wrapの子要素のuser_ranking_No_wrapと、user-icon_imgと、hopを横並びにして
                #hopの子要素のuser_ranking_username_wrapとuser_ranking_createNum_wrapとfollow-btnを縦並びにして
                %>
                      <div class="user_ranking_No_wrap"><%= i %></div><% i=i+1; %>
                      <div class="user_ranking_user_wrap">
                          <div class="cont">
                              <%= render 'shared/user_list' %> 
                          </div>
                      </div>
            <% end %>
      </div>
  
<!--
    <% if user_signed_in? %>
        <div class="UserRanking_wrap">
            <h4>ユーザーランキング</h4>
            <% @users_with_duplicated_names.each do |user|%>
                  <a href="/user/<%= user.user_name %>">
                        <p>@<%= user.user_name %><p>
                        <p>記事数：<%= 5 %><p>
                  </a>
                  <button class="follow-btn">フォロー</button>
            <% end %>
            </div>
    <% end %>
-->
    <div class="footer-wrap">
        <hr>
        <div class="link-div"><a href="/pricing" class="contact_link">料金/プラン</a></div>
        <div class="link-div"><a href="/business">ビジネス</a></div>
        <div class="link-div"><a href="/sctl">特定商取引法に基づく表記</a></div>
        <div class="link-div"><a href="/policy">プライバシーポリシー</a></div>
        <div class="link-div"><a href="/terms">利用規約</a></div>
        <div class="link-div"><a href="/contact/new" class="contact_link">お問い合わせ</a></div>
        <label for="lang_select">言語を選択:</label>
        <select id="lang_select">
            <option value="ja">日本語</option>
            <option value="en">English</option>
            <option value="zh-CN">中文</option>
        </select>
        <script>
//画面読み込み時に処理
//$(function(){
// ローカルストレージから値を取得
  //const lang= localStorage.getItem('lang');

  const lang= Cookies.get('lang');

//undefinedならまだcookieにlangが入っていないので、ブラウザの設定言語をcookieに入れる
  if (lang === undefined) {
        console.log("undefinedならまだcookieにlangが入っていないので、ブラウザの設定言語をcookiに入れる")
        // ブラウザの言語設定を取得
        const browser_language = navigator.language; 
        // 言語で条件分岐
        //let browser_lang="jp";
        let browser_lang="ja";
        if (browser_language.startsWith("ja")) {
            //browser_lang = "jp";
            browser_lang = "ja";
        } else if (browser_language.startsWith("en")) { 
            //browser_lang = "en";
            browser_lang = "en";
        } else if (browser_language.startsWith("zh")) {
            //browser_lang = "zh";
            browser_lang = "zh-CN";
        }
        console.log("browser_language:"+browser_language+"・browser_lang:"+browser_lang)
        Cookies.set('lang',browser_lang);
        lang=browser_lang;
  }

  


  //cookieから値を取得
  /*var r = document.cookie.split(';');
    r.forEach(function(value) {
    var content = value.split('=');
    lang=content[1];
    console.log("クッキー:"+content[1]);
    });
    */
  console.log("画面読み込み時の言語："+lang)

    //ドロップダウンの初期値変更
    var lang_select = document.getElementById("lang_select");
    lang_select.value = lang;


  /*if (lang=== 'jp') {
    design_light();
  }else if (lang=== 'en') {
    design_dark();
  }else if (lang=== 'zh'){
    design_dark();
  }else{
    design_dark();
  }
  */
//});

        //言語のドロップダウン変更するごとにイベント
        document.getElementById('lang_select').addEventListener('change', function() {
            var language = this.value;
            console.log('11言語のドロップダウン変更するごとにイベント');
            //localStorage.setItem('lang', this.value);//localStorage.setItem('lang', 'jp');
            //document.cookie = 'lang='+this.value;
            Cookies.set('lang',this.value);
            console.log('22言語のドロップダウン変更するごとにイベント');
            console.log('Language selected: ' + language);
            location.reload();// ページをリロードする
        });
        </script>
        <% if @current_email== "stepjump3333@yahoo.co.jp" %>
          <a href="notifications/new">通知作成</a>
        <% end %>
        <div class="link-div"><span class="copyright">© <%= Date.today.year %> Roll Tall</span></div>
    </div>
  </div>
</div>
</div>